  <!doctype html>
  <html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Digitively">
    <meta name="description" content="76JK">
    <title>76JK</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css" integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.7.2/css/all.css">
    <link rel="stylesheet" href="https://76jk.com/styles/styles.css">
    <link rel="icon" type="image/x-icon" href="https://76jk.com/images/favicon.ico">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jwt-decode@2.2.0/build/jwt-decode.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/spin.js/2.3.2/spin.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/async/3.1.0/async.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/browser-image-compression@2.0.2/dist/browser-image-compression.js"></script>
    <script type="text/javascript" src="https://76jk.com/scripts/config.js"></script>
    <script type="text/javascript" src="https://76jk.com/scripts/base.js"></script>
  </head>

  <body>
    <div class="header">
      <div class="menu pure-menu pure-menu-horizontal pure-menu-fixed">
        <ul class="pure-menu-list" style="float:left;">
          <li class="pure-menu-item"><a class="pure-menu-link" href="/index.html"><span style="color:#6B7D5F;">BONSAI</span> 76JK</a></li>
        </ul>
      </div>
    </div>

    <div class="wrapper">
      <div class="pure-g content">
        <form class="pure-form pure-u-1" action="javascript:broadcast();">
          <div class="pure-g" style="padding: 0px 22px!important;"> 

            <p class="pure-u-1" style="margin:60px 0px 0px 0px!important;">Broadcast</p>
            <textarea id="broadcast-text" class="pure-input pure-u-1" rows="6" style="margin:0px 0px 20px 0px!important;border:1px #CCCCCC solid;resize:vertical;"></textarea>

            <p class="pure-u-1" style="margin:0px 0px 5px 0px!important;">Where</p>
            <label class="pure-checkbox pure-u-1" style="margin:0px 0px 10px 0px;">
              <input type="checkbox" id="where-gate" name="where" value="gate"> GATE
            </label>
            <label class="pure-checkbox pure-u-1" style="margin:0px 0px 10px 0px;">
              <input type="checkbox" id="where-display" name="where" value="display"> DISPLAY
            </label>
            <label class="pure-checkbox pure-u-1" style="margin:0px 0px 10px 0px;">
              <input type="checkbox" id="where-speaker" name="where" value="speaker"> SPEAKER
            </label>

            <p class="pure-u-1" style="margin:10px 0px 5px 0px!important;">Voice</p>
            <label class="pure-radio pure-u-1" style="margin:0px 0px 10px 0px;">
              <input type="radio" id="voice-english" name="voice" value="english"> ENGLISH
            </label>
            <label class="pure-radio pure-u-1" style="margin:0px 0px 10px 0px;">
              <input type="radio" id="voice-chinese" name="voice" value="chinese"> CHINESE
            </label>

            <button id="broadcast-btn" type="submit" class="pure-button pure-u-1" style="margin:50px 0px 30px 0px!important;">Submit</button>
          </div>
        </form>
      </div>
    </div>

    <div class="footer">
      <div class="menu pure-menu pure-menu-horizontal">
        <ul class="pure-menu-list" style="float:left;">
          <li class="pure-menu-item"><a id="version" class="pure-menu-link"></a></li>
        </ul>
        <ul class="pure-menu-list" style="float:right;">
          <li class="pure-menu-item"><a href="mailto:hello@76jk.com" class="pure-menu-link">hello@76jk.com</a></li>
        </ul>
      </div>
    </div>

    <script type="text/javascript">
      const loadScript= function() { 
        instance.jk= getCookie("jk");
        if(!instance.jk) { location.href= "/login.html"; return; }
        instance.profile= jwt_decode(instance.jk);
      }

      const broadcast= function(callback) {
        const messageElement= document.getElementById("broadcast-text");
        const message= messageElement.value.trim();
        if(message=== "") { alert("Please enter a broadcast message."); return; }
        messageElement.value= message;

        const selectedWhere= Array.prototype.slice.call(document.querySelectorAll("input[name='where']:checked")).map(function(el) { return el.value; });
        if(selectedWhere.length=== 0) { alert("Please select at least one destination."); return; }

        const voiceInput= document.querySelector("input[name='voice']:checked");
        if(!voiceInput) { alert("Please choose a voice."); return; }

        const action= "broadcast";
        const url= instance.endpoint + "/" + action.toLowerCase();
        const variables= ["jk", "text", "where", "voice"];
        const required= ["jk", "text", "where", "voice"];
        const values= { "text": message, "where": selectedWhere.join(","), "voice": voiceInput.value };
        const type= "application/x-www-form-urlencoded";
        post(type, url, action, variables, required, values, function(err, res) {
          if(err) { alert(err); return; }
          alert("Broadcast submitted.");
        });
      }
    </script>

  </body>
  </html>
